# 🚀 快速启动指南

## 前置准备

### 1. 检查Python环境
```bash
python --version
```
需要 Python 3.9 或更高版本

### 2. 安装依赖
```bash
pip install -r requirements.txt
```
或者单独安装：
```bash
pip install paho-mqtt pandas flask schedule
```

### 3. 确保Mosquitto MQTT服务器运行

**Windows:**
- 检查服务是否运行：
  ```powershell
  netstat -ano | findstr :1883
  ```
- 如果没有运行，启动Mosquitto服务（通常在服务管理器中）

**Linux/Mac:**
```bash
# 检查状态
sudo systemctl status mosquitto

# 启动服务
sudo systemctl start mosquitto
```

## 🎯 启动步骤

### 方法一：快速启动（推荐）

**步骤1：启动发布端**
打开第一个终端窗口，执行：
```bash
cd D:\LOT
python publish_app.py
```
✅ 发布端将在 `http://127.0.0.1:5000/` 启动

**步骤2：启动订阅端**
打开第二个终端窗口，执行：
```bash
cd D:\LOT
python subscribe_app.py
```
✅ 订阅端将在 `http://127.0.0.1:5001/` 启动

### 方法二：使用批处理脚本（Windows）

创建 `start_publish.bat`:
```batch
@echo off
cd /d D:\LOT
python publish_app.py
pause
```

创建 `start_subscribe.bat`:
```batch
@echo off
cd /d D:\LOT
python subscribe_app.py
pause
```

双击这两个批处理文件即可启动。

## 📱 使用流程

### 1. 访问订阅端
1. 打开浏览器访问：`http://127.0.0.1:5001/`
2. 输入ClientID（可选：AccessKey ID和Secret）
3. 点击"订阅"按钮连接

### 2. 访问发布端
1. 打开浏览器访问：`http://127.0.0.1:5000/`
2. 点击"连接"按钮连接到MQTT服务器
3. 点击"发布随机数据"或"发布所有数据"发送数据

### 3. 查看数据
- 在订阅端可以看到实时接收的数据
- 点击"温度"、"湿度"、"气压"按钮查看可视化图表
- 点击"预测"查看数据预测结果

## ⚠️ 常见问题

### 问题1：端口被占用
**错误信息：** `Address already in use`

**解决方法：**
```bash
# Windows - 查找占用端口的进程
netstat -ano | findstr :5000
netstat -ano | findstr :5001

# 结束进程（替换PID为实际进程ID）
taskkill /F /PID <进程ID>
```

### 问题2：无法连接到MQTT服务器
**错误信息：** `Connection refused`

**解决方法：**
1. 检查Mosquitto是否运行：
   ```bash
   netstat -ano | findstr :1883
   ```
2. 如果没有运行，启动Mosquitto服务
3. 检查防火墙设置

### 问题3：缺少依赖包
**错误信息：** `ModuleNotFoundError`

**解决方法：**
```bash
pip install paho-mqtt pandas flask schedule
```

### 问题4：找不到数据文件
**错误信息：** `FileNotFoundError`

**解决方法：**
- 确保 `THPData/THP_data.csv` 文件存在
- 确保 `forecast-data/` 目录下有预测数据文件

## 🔧 停止服务

### 方法1：在终端中按 `Ctrl+C`

### 方法2：关闭终端窗口

### 方法3：使用任务管理器（Windows）
1. 打开任务管理器（Ctrl+Shift+Esc）
2. 找到Python进程
3. 结束进程

## 📝 启动顺序建议

1. ✅ 先启动Mosquitto服务器
2. ✅ 再启动订阅端（subscribe_app.py）
3. ✅ 最后启动发布端（publish_app.py）

这样可以确保订阅端已经准备好接收数据。

## 🎨 功能说明

- **发布端（端口5000）**：用于发布传感器数据
- **订阅端（端口5001）**：用于接收和可视化数据
- **数据可视化**：实时图表和历史数据展示
- **数据预测**：基于历史数据的未来预测

---

**提示：** 如果遇到任何问题，请查看终端输出的错误信息，或参考 `运行方法.md` 和 `说明文档.md` 获取详细帮助。


